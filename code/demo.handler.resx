<%
dim html,titletag,body

titletag="aspLite demo"

'load the template
html=aspL.load("html/demo.asp/demo.resx")

'here you can typically add some sort of eventhandler (what did the user do exactly?)
'in general: if the code for dealing with the event is not large, include it here.
'if the code is getting complex, use yet another codebehind file, like in the examples below (helloworld, mail, json, etc)

select case lcase(aspL.getRequest("e")) '"event"
		
	case "clicklink"
		
		body="Link was clicked"		
		
	case "clickbutton"
	
		body="Regular form was submitted"		
		
	case "loadclass"
	
		'CONDITIONAL load of asp page = include file
		aspL.exec("code/demo.asp/class.resx")	
		
		dim testObj
		set testObj=new cls_test
		body=testObj.hello
		set testObj=nothing	
		
	
	case "downloadlargefile"
	
		aspL.dumpBinary("html/demo.asp/largefile.jpg")
	
	case "downloadsmallfile"
	
		aspL.dumpBinary("html/demo.asp/smallfile.jpg")
	
	case "helloworld"
	
		aspL.exec("code/demo.asp/helloworld.resx")	
		
	case "randomizer"
	
		aspL.exec("code/demo.asp/randomtext.resx")		
		
	case "accessdb"
	
		aspL.exec("code/demo.asp/datasample.resx")	
		
	case "jquerydatatable"
	
		aspL.exec("code/demo.asp/jquerydatatable.resx")
		
	case "ckeditor"
		
		aspL.exec("code/demo.asp/ckeditor.resx")
				
	case "upload"
	
		body=aspL.load("html/demo.asp/singleupload.resx")
		
	case "uploadfile"

		aspL.exec("code/demo.asp/uploadfile.resx")	
	
	case "uploadmulti"
	
		body=aspL.load("html/demo.asp/multiupload.resx")
		
	case "jszip"
	
		aspL.exec("code/demo.asp/jszip.resx")	
		
	case "login"
		'this will load a completely different template.
		'because we override the html variable.
		'this has as such nothing to do with aspLite. It's just a technique that can be used.
		html=aspL.load("html/demo.asp/login.resx")		
	
	
	'AJAX handlers
		
	case "ajaxhello"
		
		aspL.dump "Hello " & aspL.sanitize(aspL.URLDecode(aspL.getRequest("yourname"))) & ".<br><br>Hashed (sha256):<br><br><textarea class=""form-control"">" & aspL.plugin("sha256").sha256(aspL.getRequest("yourname")) & "</textarea>"

	case "submit1"
	
		aspL.dump "Form 1 save button was clicked - " & aspL.getrequest("yourname")
		
	case "linksubmit"
	
		aspL.dump "Form 1 submitted by link - " & aspL.getrequest("yourname")
	
	case "delete1"
	
		aspL.dump "Form 1 delete button was clicked - " & aspL.getrequest("yourname")
		
	case "submit2"
	
		aspL.dump "Form 2 save button was clicked"
	
	case "delete2"
	
		aspL.dump "Form 2 delete button was clicked"
		
	case "buttonclick"
	
		aspL.dump "Regular button was clicked"
		
	case "clicklink1"

		aspL.dump "First link clicked..."
	
	case "clicklink2"

		aspL.dump "Second link clicked..."	
	
	case "returnbool"	
		
		aspL.dump aspL.plugin("randomizer").randomnumber(0,100)>49	
		
	case "returndata"

		aspL.exec("code/demo.asp/datatable.resx")	
	
	case "hash"
	
		aspL.exec("code/demo.asp/hash.resx")	
		
	case "returnjsondata"
	
		aspL.exec("code/demo.asp/json.resx")
		
	case "sendmail"
		
		aspL.exec("code/demo.asp/mailhandler.resx")		

	case "rss"
	
		dim rss
		set rss=aspL.plugin("rss")
		aspL.dump rss.read("http://rss.cnn.com/rss/cnn_topstories.rss")
		
	case "jpg"	
	
		aspL.exec("code/demo.asp/jpghandler.resx")	
	
	case "uploadjquery" 'screen
	
		aspL.dump(aspL.load("html/demo.asp/uploadjquery.resx"))
	
	case "uploadfilejquery" 'uploader
	
		aspL.exec("code/demo.asp/uploadfile.resx")
		aspL.die
		
	case "jscript"
	
		'server.execute executes a remote asp(-only) page that resides on the same server
		'that asp page has access to the response and request collection
		'the remote asp page has however no access to the aspL object 
		'or any other object that was created so far
		'in this case, a JScript sample page was loaded.
		server.execute("code/demo.asp/jscript.asp")		
		aspL.die
		
	case "onload" 'default content for AJAX handler	
	
		aspL.dump "Hello world, Καλημέρα κόσμε (utf8-ready)"
		
	case else 'default content for REGULAR handler
	
		body="No (known) action was detected. Initial load."
		
		'get userfriendly url, if any
		if not aspL.isLeeg(aspl.pathinfo) then
			body="A non-existing item <strong>" & aspl.pathinfo & "</strong> was requested."
		end if
		
end select

%>