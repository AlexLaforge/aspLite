<%
on error resume next

dim uploadsDirVar, filesize, filename, errorMessage

'default path: uploads
uploadsDirVar = server.MapPath ("uploads") 

dim upload
Set upload = aspL.plugin("uploader")

upload.Save uploadsDirVar

dim ks, fileKey, strMessage
ks = Upload.UploadedFiles.keys
'if (UBound(ks) <> -1) then
	for each fileKey in Upload.UploadedFiles.keys
		
		filesize=Upload.UploadedFiles(fileKey).Length
		filename=Upload.UploadedFiles(fileKey).filename
				
		body=body & "<p>The file <strong>" & aspL.sanitize(filename) & " (" & round(filesize/1024,0) & " kB)</strong> was successfully uploaded (and removed again).</p>"
		
		'for security reasons, I immediately remove the uploaded files.
		Upload.UploadedFiles(fileKey).delete()
		
	next
'end if

if not aspL.isleeg(upload.errorMessage) then
	body=upload.errorMessage
	errorMessage=body
end if

set upload=nothing

on error goto 0

%>