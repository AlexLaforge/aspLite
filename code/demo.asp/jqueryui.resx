<%
'load template
body=aspL.load("html/demo.asp/jqueryui.resx")

'select a date-format
dim dateformat
dateformat="dd/mm/yy" 'or mm/dd/yy see dateFromDatepicker below
body=replace(body,"[dateformat]",dateformat,1,-1,1)

dim today,vbDate

if not aspl.isLeeg(aspL.getRequest("today")) then	
	
	'form was submitted. 
	
	today=aspL.getRequest("today")
	
	'be careful... the selected date is not necessarely a valid VBScript date. 
	'It's a string actually. It has to be converted to a VBScript date!
	
	vbDate=dateFromDatepicker(today)
	
	body=replace(body,"[feedback]","<p>You selected <strong>" & FormatDateTime(vbDate,1) & "</strong> (vbLongDate)</p>",1,-1,1)
	
else

	'aspl.convert2() converts 1 to 01, 2 to 02 and so on (needed for Datepicker)
	today=aspl.convert2(day(date)) & "/" & aspl.convert2(month(date)) & "/" & year(date)
	body=replace(body,"[feedback]","",1,-1,1)
	
end if

body=replace(body,"[today]",today,1,-1,1)


function dateFromDatepicker(theDate)
	
	if not aspL.isLeeg(theDate) then
	
		dim arrDate
		arrDate=split(theDate,"/")
		
		select case dateformat
			case "dd/mm/yy"
				dateFromDatepicker=dateserial(arrDate(2),arrDate(1),arrDate(0))
			case "mm/yy/yy"
				dateFromDatepicker=dateserial(arrDate(2),arrDate(0),arrDate(1))
		end select
	
	else
	
		dateFromDatepicker=""
		
	end if
	
end function

%>