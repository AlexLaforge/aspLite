<p>See <a target="_blank" href="https://datatables.net/">DataTables</a> jQuery plugin</p>
<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
<script src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="//cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>


<style>
.dataTables_wrapper .dataTables_processing {
height: 60px;
font-size: 1em;
}

</style>

<h3>DataTables / Server Side Processing (Classic ASP)</h3>

<hr>

<p>Loading some dozens or even hundreds of records at once works fine. But what if you want to browse 10000's? The table below browses (sorts and searches) 50.000 records. Only the records shown are actually loaded. This speeds up the page loadtime (a lot). I found inspiration for this feature <a href="https://datatables.net/forums/discussion/59746/new-classic-asp-server-side-script-for-datatables-1-10-20" target="_blank">here</a> (SlavTheClaw). </p>

<hr>

<table id="jsExampleSSP" class="table table-striped" style="width:100%">
	<thead>
		<tr>
			<th style="text-align:center">
				<button class="btn btn-info" style="padding:2px 7px" onclick="askAspForm(null)">Add&nbsp;new</button>
			</th>			
			<th>text</th>
			<th>number</th>
			<th>boolean</th>
			<th>date</th>			
		</tr>
	</thead>
</table>

<!-- bootstrap modal window -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modify record</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
	  <div id="editForm"></div>
    </div>
  </div>
</div>

<script>
function askAspForm (id) {
	aspAjax ("post","demo.asp?iId=" + id + "&e=postdtt","text","",getAspForm)
}

function getAspForm(data) {
	$('#editForm').html(data)
	$("#exampleModal").modal()
}

$(document).ready( function () {	
	
	$('#jsExampleSSP').DataTable( {	
		
		"order": [1,"asc"],		
		"responsive": true,
		"serverSide": true,
		"ajax": 'demo.asp?e=json_datatables_data',
		"processing": true,
		"columnDefs": [
				{"targets": '_all',"render":$.fn.dataTable.render.text()},
				{ "orderable": false, "targets": 0 },
				{targets: 0,className: 'dt-body-center'}
			],		
		"columns": [           
			{  data: "iId", render: function ( data, type, row ) {				
				return '<button class="btn btn-secondary" style="padding:2px 14px" onclick="askAspForm(' + data + ')">Modify</button>'							
				}
			},			
			{ "data": "sText"},
            { "data": "iNumber" },
			{ "data": "bBoolean" },
			{ "data": "dDate" }
			]
	} );	
});
</script>