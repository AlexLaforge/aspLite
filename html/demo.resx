<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<!-- jQuery & generic AJAX functions -->
	<script src="js/jquery.js"></script>
	<script src="js/aspAjax.js"></script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>[TITLETAG]</title>
	
<style>
	body {
		padding-top: 5rem
	}
	.starter-template {
		padding: 3rem 1.5rem;
		text-align: center
	}
</style>
  </head>
  <body>
  
		<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
			
			<a class="navbar-brand" href="default.asp">aspLite</a>
			
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarsExampleDefault">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item">
						<a class="nav-link" href="default.asp">back</a>
					</li>			
					  
					  <li class="nav-item active dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">AJAX Event Handler</a>
						<div class="dropdown-menu"  aria-labelledby="dropdown01">
						  <a class="aspAjax dropdown-item" id="clicklink1" href="#">Click a first link</a>
						  <a class="aspAjax dropdown-item" id="clicklink2" href="#">Click a second link</a>
						  <a class="aspAjax dropdown-item" id="jpg" href="#">Get images from server</a>						  
						  <a class="aspAjax dropdown-item" id="returnbool" href="#">Get random boolean from server</a>
						  <a class="aspAjax dropdown-item" id="rss" href="#">Read the news</a>					  
						</div>
					  </li>
				</ul>
			</div>
		</nav>

		<main role="main" class="container">

		  <div class="starter-template">
			<h1>[PAGETITLE]</h1>
			<p class="lead">Bootstrap can easily be included in your template file.</p>			
		  </div>
		  
		   <div class="row">
				<div class="col-sm">
				
					<h5>Output REGULAR handler:</h5>						
					<div class="alert alert-success" role="alert"><p class="mb-0">[BODY]</p></div>					
				   
					<ul>
						<li><a href="demo.asp">No action</a></li>
						<li><a href="demo.asp?action=clicklink">Clink link</a></li>
						<li><a href="demo.asp?action=loadclass">conditionally load asp file</a></li>
						<li><a href="demo.asp?action=downloadsmallfile">download small file (&lt;500kB)</a></li>
						<li><a href="demo.asp?action=downloadlargefile">download large file (&gt;500kB)</a></li>
						<li><a href="demo.asp?action=helloworld">hello world plugin</a></li>
						<li><a href="demo.asp?action=randomizer">randomizer plugin</a></li>
						<li><a href="demo.asp?action=accessdb">Access DB plugin</a></li>
					</ul>
				   
				   
				   <form action="demo.asp" method="post">						
						<button class="btn btn-danger" type="submit" value="clickbutton" id="action" name="action">click button</button>		
					</form>	
				   
				   
				</div>
				<div class="col-sm">
				   
					<h5>Output AJAX handler:</h5>
					<div id="body" class="alert alert-primary" role="alert">[BODY]</div>						
										
					<form class="ajaxForm" action="default.asp">
						<div class="input-group mb-3">
							<input type="hidden" name="ajaxaction" value="ajaxhello" />							
							<input placeholder="Your name" id="yourname" class="form-control" name="yourname" type="text" />
							<input type="submit" class="btn btn-primary" value="AJAX" />
						</div>
							
					</form>	
					
					<hr>
					
					<p>JSON datatable</p>
					<ul>
						<li><a class="aspAjaxData" href="#" id="returnjsondata">Get some JSON data (from database)</a></li>		
					</ul>
					
					<hr>

					<p>Form 1</p>
					<form class="ajaxForm" id="form1" action="#" method="post">
						<input type="hidden" id="ajaxaction" name="ajaxaction" value="">
						
						<div class="form-group">
							<input type="text" class="form-control" name="yourname" placeholder="utf8" value="Hello world, Καλημέρα κόσμε, コンニチハ" />
						</div>
						
						<input onclick="$('#ajaxaction').val('submit1')" class="btn btn-success" type="submit" value="Save">
						<input onclick="$('#ajaxaction').val('delete1')" class="btn btn-info" type="submit" value="Delete">
						<a class="btn btn-dark" href="#" onclick="$('#ajaxaction').val('linksubmit');$('#form1').submit();return false">Submit link</a>
					</form>
					
					<hr>

					<p>Form 2</p>
					<form class="ajaxForm" action="#" method="post">
						<input type="hidden" id="ajaxaction2" name="ajaxaction" value="">
						<input onclick="$('#ajaxaction2').val('submit2')" class="btn btn-secondary" type="submit" value="Save">
						<input onclick="$('#ajaxaction2').val('delete2')" class="btn btn-warning" type="submit" value="Delete">
					</form>
					
					<hr>

					<p>Button</p>
					<button class="aspAjax btn btn-primary" id="buttonclick" type="button">Click Me!</button>
						
					
					<hr>									
					
				</div>
				
			</div>  

		</main>

<!-- /.container --> 
   
<script>

	var aspAjaxUrl='demo.asp'

	$(document).ready(function(e) {		
		onPageLoad()
	})

	$('.aspAjax').click(function(e) {
		e.preventDefault()
		aspAjax('GET',aspAjaxUrl,'text','ajaxaction=' + this.id,aspAjaxSuccess)
	})

	$('.ajaxForm').submit(function(e) {
		e.preventDefault()
		aspAjax('POST',aspAjaxUrl,'text',$(this).serialize(),aspAjaxSuccess)
	})
	
	$('.aspAjaxData').click(function(e) {
		e.preventDefault()
		aspAjax('GET',aspAjaxUrl,'json','ajaxaction=' + this.id,jsonToTable)
	})

	function onPageLoad () { 
		aspAjax('GET',aspAjaxUrl,'text','ajaxaction=onload',aspAjaxSuccess)	
	}

	function aspAjaxSuccess(data) {
		$('#body').html(data)	
	}
	
	function jsonToTable(data) {
	
		var persons=data.persons //expects parsed json
		var liPersons=''
			
		if (persons.length==0) {
			$('#body').html('<p>no records found</p>')
			return
		}
		
		for (var i = 0; i < persons.length; i++) {
		
			var person=persons[i]	
		
			for (var key in person) {
				liPersons+='<th scope="col">' + key + '</th>'
			}
			
			break	// stop after 1 loop just to get the table headers
		
		}
		
		liPersons='<tr>' + liPersons + '</tr>'	
			
		for (var i = 0; i < persons.length; i++) {
		
			liPersons+='<tr>'
		
			var person=persons[i]
			
			for (var key in person) {
				liPersons+='<td>' + (person[key]) + '</td>'
			}
			
			liPersons+='</tr>'
			
		}
		
		$('#body').html('<br><table class="table table-striped">' + liPersons + '</table>')
		
	}	

</script>

 <!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  
 [TIMER] 
  </body>
</html>